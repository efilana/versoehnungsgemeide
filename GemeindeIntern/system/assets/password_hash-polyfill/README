Taken from https://github.com/ircmaxell/password_compat under MIT license
